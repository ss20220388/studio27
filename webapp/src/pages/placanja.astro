---
import Layout from "../layouts/Layout.astro";
import PlacanjaComponents from "../components/PlacanjeComponents.astro";

interface Placanje {
    studentId: number;
    ime: string;
    prezime: string;
    email: string;
    brojTelefona: string;
    datumPlacanja: string;
    cenaPlacanja: number;
}

const data: Response = await fetch("http://localhost:8080/api/placanje");
if (!data.ok) throw new Error("Ne mogu da dobijem placanja");

const result = await data.json();

// Ako backend vraÄ‡a objekat { kursevi: [...] }
const kursevi: Placanje[] = Array.isArray(result) ? result : result.placanja || [];
---
<Layout title="Moja placanja">
    <main class="p-8">
        <h1 class="text-3xl font-bold mb-8">Moja placanja</h1>

        {kursevi.length === 0 ? (
            <p>Nema placanja za prikaz</p>
        ) : (
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {kursevi.map((placanje) => (
                    <PlacanjaComponents mojiPlacanja={[placanje]} />
                ))}
            </div>
        )}
    </main>
</Layout>
